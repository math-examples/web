<html>
<!-- ç½‘é¡µæµè§ˆå™¨ -->
<head>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>è¯»ä¸‡å·ä¹¦</title>

    <script>
        function getMyWebPath() {
            var uri = window.location.toString();
            if (uri.indexOf("?") > 0) {
                return uri.substring(0, uri.indexOf("?"));
            } else return "";
        }

        function getQueryHref(paramsString) {
            const params = new URLSearchParams(paramsString);
            const title = params.get("title");
            const href = params.getAll("href");
            if (href.length != 0) {
                return href[0];
            } else return "";
        }

        function getTrueQueryHref(txtHref) {
            if (txtHref) {
                const myPath = getMyWebPath();
                if (myPath.length > 0 && txtHref.startsWith(myPath)) {
                    const queryString = txtHref.replace(myPath, '');
                    txtHref = getQueryHref(queryString);
                }
            }
            return txtHref;
        }

        // Prevent web page from being loaded inside iFrame.
        if (window.top !== window.self) {
            const txtHref = document.location.href;
            document.location.href = getTrueQueryHref(txtHref);
        }
    </script>

    <link rel="stylesheet" href="https://math-examples.github.io/web/tts.css"/>
    <script src="https://math-examples.github.io/web/math-examples.js"></script>

    <script>
        //if(typeof globalHasIframe=== 'undefined')alert("no globalHasIframe");
    </script>

    <style type="text/css">
        a {
            color: #07519a;
            text-decoration: none;
        }

        img {
            height: auto;
            width: 100%;
            object-fit: contain;
        }
    </style>

    <style>
        * {
            box-sizing: border-box;
        }

        .left {
            /* background-color:#2196F3; */
            padding: 20px;
            float: left;
            width: 100%; /* The width is 20%, by default */
        }

        .main {
            /* background-color:#f1f1f1; */
            padding: 20px;
            float: left;
            width: 0%; /* The width is 60%, by default */
        }

        .right {
            /* background-color:#4CAF50;*/
            padding: 20px;
            float: left;
            width: 0%; /* The width is 20%, by default */
        }

        /* Use a media query to add a break point at 800px: */
        @media screen and (max-width: 800px) {
            .left, .main, .right {
                width: 100%; /* The width is 100%, when the viewport is 800px or smaller */
            }
        }

        #ttsSetting {
            display: none;
        }

        .curContent {
            display: none;
        }

    </style>

</head>

<body>

<h2>ğŸ“–ğŸ–‹</h2>

<div>

    <!--
        <form id="form">
        <input class="input" id="codeInput" type="text" placeholder="è¾“å…¥å†…å®¹" name="message">
      </form>

      <button class="button" onclick="search()">æœç´¢</button>
    -->


    <button class="button" id="toggler" onclick="myToggle()">é˜…è¯»ğŸ“–</button>

    <button class="button" id="changeBgColor" onclick="changeBgColor()">èƒŒæ™¯ğŸŒˆ</button>

    <button class="button" id="resizeText1" onclick="resizeText(1)">å­—ä½“â•ï¸</button>

    <button class="button" id="resizeText2" onclick="resizeText(-1)">å­—ä½“â–ï¸</button>

    <button class="button" id="speak" onclick="speak()">æœ—è¯»ğŸ”Š</button>

    <button class="button" id="contact" onclick="contact()">è”ç³»ğŸ“</button>

    <!-- <button class="button" id="pause" onclick="pause5()">æš‚åœâ¤<button> -->

</div>

<div id="ttsSetting">
    <form>
        <div>
            <label for="rate">è¯­é€Ÿ</label>
            <input type="range" min="0.5" max="2" value="1" step="0.1" id="rate"/>
            <div class="rate-value">1</div>
        </div>

        <div>
            <label for="pitch">éŸ³è°ƒ</label>
            <input type="range" min="0" max="2" value="1" step="0.1" id="pitch"/>
            <div class="pitch-value">1</div>
        </div>

        <select></select>
    </form>
</div>

<div class="left">

    <iframe class="oriContent" id="oriWeb" src="" width="100%" height="100%" style="border:none;">
    </iframe>
    <!--<pre class="oriContent" id="oriText">Empty</pre> -->

    <div class="curContent" id="txt2html">
        <p>åŠ è½½ä¸­...</p>
    </div>

</div>

<div class="main">
</div>

<div class="right">

</div>

<script>

    var i_extractTxt = 0;

    function extractTxt() {
        //if(i_extractTxt)return;
        //let y = `scode=
        let x = `code=var txt = html2txt();
window.top.postMessage(txt, trustedOrigins[0]);
`;
        runCode(x);
    }

    function search() {
        let codeInput = document.getElementById('codeInput');
        let x = codeInput.value;
        runCode(x);
    }

    function onMsg(event) {
        let txt = event.data;
        if (txt && txt.length > 0) {
            i_extractTxt = 1;
            txt2html(txt);
        }
        //runCode(event.data);
        //if (!trustedOrigins.includes(event.origin)) return;
        //alert(`Message from an iframe: ${event.origin}`);
        //alert(`Message from an iframe: ${event.data} from ${event.origin}`);
        if (event.data === 'succeeded') {

        }
    }

</script>

<script language="JavaScript">

    function processIndicator() {
        if (window.self !== window.top) {
            return;
        }// required
        showLog("ç½‘é¡µåŠ è½½ä¸­âŒ›ï¸â³ï¸");
        let xw = document.getElementById('oriWeb');
        xw.addEventListener('load', function () {
            showLog("ç½‘é¡µåŠ è½½å®Œæ¯•");
        });
    }

    txtHref = "";

    function processUser() {
        if (txtHref != "") return;

        txtHref = getQueryHref(window.location.search);

        //const txtHref2 = "https://math-examples.github.io/web-debug/iframe.html";
        if (txtHref) {
            let xw = document.getElementById('oriWeb');
            xw.src = txtHref;
            processIndicator();
        }

    }

    function myToggle() {
        toggle(`.curContent`, `.oriContent`, 'é˜…è¯»ğŸ“–', 'è¿”å›â†©ï¸', toggleCb1, toggleCb2);
    }

    function toggleCb1() {
        extractTxt();
        toggleFullscreen1();
    }
    
    function toggleCb2() {
        toggleFullscreen2();
    }

    function init() {

        window.addEventListener("message", onMsg, false);
        processUser();

        document.addEventListener("readystatechange", (event) => {
            if (event.target.readyState === "interactive") {
                try {

                } catch (e) {
                    showLog(e.message);
                }
                //initLoader();
            } else if (event.target.readyState === "complete") {
                //initApp();
            }
        });
    }

    init();

    // tag h1, h2 used by showLog
    function contact() {
        const s = `<div class="content">
<h3>
<span class="emoji">ğŸ“</span>
è”ç³»
</h3>
<ul>
<li>ğŸ‘‹ æœ¬è½¯ä»¶æ— éœ€ä¸‹è½½ï¼Œåªè¦ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå°±å¯ä»¥è¯»ä¹¦ï¼Œæ¬¢è¿ä½¿ç”¨ã€‚ç«ç‹æµè§ˆå™¨åä¸ºæ‰‹æœºå¯ä»¥æ­£å¸¸æœ—è¯»ï¼Œè°·æ­Œæµè§ˆå™¨ä¸èƒ½ä¿è¯ã€‚</li>
<li>ğŸ— è™½ç„¶ä¸ä¿è¯èƒ½è§£å†³ï¼Œä½†æ˜¯è¿˜æ˜¯å¸Œæœ›å¤šç»™ä¸€äº›é—®é¢˜åé¦ˆï¼Œè°¢è°¢æ”¯æŒ:&nbsp;<a href="mailto:xbxoxo@gmail.com?subject=è¯»ä¸‡å·ä¹¦é—®é¢˜åé¦ˆ">é‚®ä»¶è”ç³»</a></li>
</ul>
</div>`;
        showLogLong(s);
    }

</script>

</body>

</html>
